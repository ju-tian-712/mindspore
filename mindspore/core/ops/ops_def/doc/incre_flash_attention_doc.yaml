incre_flash_attention:
  description: |
    The interface for fully inference.

    B -- Batch size

    S -- Sequence length

    H -- Hidden size

    .. warning::
        This is an experimental API that is subject to change or deletion.
        If there is no input parameter and no default value, None needs to be passed.

    Args:
        - **num_heads** (int) - The number of heads.
        - **input_layout** (str) - the data layout of the input qkv, support `(BSH)` and `(BNSD)`. Default `BSH`.
        - **scale_value** (double) - The scale value indicating the scale coefficient, which is used as the scalar of
            Muls in the calculation. Default: 1.0.
        - **num_key_value_heads** (int) - head numbers of key/value which are used in GQA algorithm.
            The value o indicates if the key and value have the same head nums, use numHeads.  Default: 0.
        - **block_size** (int) - Default: 0.
        - **inner_precise** (int) - Default: 1.

    Inputs:
        - **query** (Tensor) - The query tensor with data type of float16 or bfloat16.
          Input tensor of shape :math:`(B, 1, H)` / :math:`(B, N, 1, D)`.
        - **key** (TensorList) - The key tensor with data type of float16 or bfloat16 or int8.
          Input tensor of shape :math:`(B, S, H)` / :math:`(B, N, S, D)`.
        - **value** (TensorList) - The value tensor with data type of float16 or bfloat16 or int8.
          Input tensor of shape :math:`(B, S, H)` / :math:`(B, N, S, D)`.
        - **attn_mask** (Tensor) - The attention mask tensor with data type of bool or int8 or uint8.
          Input tensor of shape :math:`(B, S)` / :math:`(B, 1, S)` / :math:`(B, 1, 1, S)`.
        - **actual_seq_lengths** (Tensor) - Describe actual sequence length of each input with data type of int32 or
          int64.
        - **pse_shift** (Tensor) - The position encoding tensor with data type of float16 or bfloat16.
        - **dequant_scale1** (Tensor) - Quantitative parametor, the tensor with data type of uint64 or float32. It is
          disable now.
        - **quant_scale1** (Tensor) - Quantitative parametor, the tensor with data type of float32. It is disable now.
        - **dequant_scale2** (Tensor) - Quantitative parametor, the tensor with data type of uint64 or float32. It is
          disable now.
        - **quant_scale2** (Tensor) - Quantitative parametor, the tensor with data type of float32.
        - **quant_offset2** (Tensor) - Quantitative parametor, the tensor with data type of float32.
        - **antiquant_scale** (Tensor) - Quantitative parametor, the tensor with data type of float16 or bfloat16.
        - **antiquant_offset** (Tensor) - Quantitative parametor, the tensor with data type of float16 or bfloat16.
        - **block_table** (Tensor) - The tensor with data type of int32.
        - **kv_padding_size** (Tensor) - The tensor with data type of int64.

    Outputs:
        - **attention_out** (Tensor) - Input tensor of shape :math:`(B, 1, H)` / :math:`(B, N, 1, D)`.

    Supported Platforms:
        ``Ascend``