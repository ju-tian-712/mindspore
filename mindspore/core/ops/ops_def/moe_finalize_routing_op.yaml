#operator moe_finalize_routing
moe_finalize_routing:
  args:
    expanded_x:
      dtype: tensor
    x1:
      dtype: tensor
    x2:
      dtype: tensor
      default: None
    bias:
      dtype: tensor
      default: None
    scales:
      dtype: tensor
      default: None
    expanded_row_idx:
      dtype: tensor
      default: None
    expanded_expert_idx:
      dtype: tensor
      default: None
  args_signature:
    dtype_group: (expanded_x, x1, x2, bias, scales), (expanded_row_idx, expanded_expert_idx)
  returns:
    y:
      dtype: tensor
  dispatch:
    enable: True
    Ascend: MoeFinalizeRoutingAscend
    CPU: MoeFinalizeRoutingCPU
